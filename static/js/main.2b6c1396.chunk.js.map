{"version":3,"sources":["App.js","reportWebVitals.js","index.js"],"names":["App","props","state","svgRef","React","createRef","p","d3","domain","range","Math","PI","values","map","o","sin","console","log","this","arrayBuffer","doAudio","stepper","stepperIndex","scaleAudioY","scaleAudioLerp","length","channel","numberOfChannels","nowBuffering","getChannelData","i","audioCtx","window","AudioContext","webkitAudioContext","resume","analyser","createAnalyser","smoothingTimeConstant","gainNode","createGain","myArrayBuffer","createBuffer","sampleRate","triggerBufferUpdate","source","createBufferSource","buffer","connect","gain","value","destination","loop","start","canvas","document","querySelector","canvasCtx","getContext","WIDTH","width","HEIGHT","height","fftSize","bufferLength","dataArray","Uint8Array","clearRect","draw","requestAnimationFrame","getByteTimeDomainData","fillStyle","fillRect","lineWidth","strokeStyle","beginPath","sliceWidth","x","y","moveTo","lineTo","stroke","className","style","position","d","type","defaultValue","transform","top","left","onChange","target","Number","Component","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"4SAmBqBA,E,kDAEjB,WAAaC,GAAQ,IAAD,uBAClB,cAAMA,IACDC,MAAQ,GACb,EAAKC,OAASC,IAAMC,YACpB,IAAMC,EAAIC,MAAiBC,OAAO,CAAC,EAAE,KAAKC,MAAM,CAAC,EAAU,EAARC,KAAKC,KAJtC,OAKlB,EAAKC,OAASL,IAAS,IAAIM,KAAI,SAAAC,GAAI,OAAQ,GAAGJ,KAAKK,IAAIT,EAAEQ,IAAK,MAL5C,E,qDAUpB,WAEEE,QAAQC,IAAI,WAQZC,KAAKC,YAAcD,KAAKE,Y,iCA2B1B,WAOE,IANA,IACIC,EAAU,EACVC,EAAe,EACbC,EAAchB,MAAiBC,OAAO,CAAC,EAAE,MAAMC,MAAM,CAAC,GAAG,IAC3De,EAAiBjB,MAAiBC,OAAO,CAAC,EAJ7B,KAKdC,MAAM,CAACS,KAAKN,OAAOU,GAAeJ,KAAKN,QAAQU,EAAa,GAAGJ,KAAKN,OAAOa,UACrEC,EAAU,EAAGA,EAAUR,KAAKC,YAAYQ,iBAAkBD,IAEjE,IADA,IAAIE,EAAeV,KAAKC,YAAYU,eAAeH,GAC1CI,EAAI,EAAGA,EAAIZ,KAAKC,YAAYM,OAAQK,IAE3CF,EAAaE,GAAKP,EAAYC,EAAeH,MAC7CA,EAXa,KAaXA,EAAU,EACVC,GAAgB,EAChBA,GAA8BJ,KAAKN,OAAOa,OAC1CD,EAAiBjB,MAAiBC,OAAO,CAAC,EAhB/B,KAiBRC,MAAM,CAACS,KAAKN,OAAOU,GAAeJ,KAAKN,QAAQU,EAAa,GAAGJ,KAAKN,OAAOa,a,qBAMtF,WACE,IAAIM,EAAW,IAAKC,OAAOC,cAAgBD,OAAOE,oBAElDH,EAASI,SACTnB,QAAQC,IAAIc,GAEZ,IAAIK,EAAWL,EAASM,iBAGxBD,EAASE,sBAAwB,IAEjC,IAAMC,EAAWR,EAASS,aAC1BxB,QAAQC,IAAIc,EAAS7B,OAKrB,IAAIuC,EAAgBV,EAASW,aAAa,EAAyB,EAAtBX,EAASY,WAAgBZ,EAASY,YAC/EzB,KAAKC,YAAcsB,EAKnBvB,KAAK0B,sBAIL,IAAIC,EAASd,EAASe,qBAGtBD,EAAOE,OAASN,EAChBI,EAAOG,QAAQZ,GAEfG,EAASU,KAAKC,MAAQ,IACtBL,EAAOG,QAAQT,GACfA,EAASS,QAAQjB,EAASoB,aAC1BN,EAAOO,MAAO,EACdP,EAAOQ,QAGP,IAAIC,EAASC,SAASC,cAAc,eAChCC,EAAYH,EAAOI,WAAW,MAE9BC,EAAQL,EAAOM,MACfC,EAASP,EAAOQ,OAEpB1B,EAAS2B,QAAU,KACnB,IAAIC,EAAe5B,EAAS2B,QAC5B/C,QAAQC,IAAI+C,GACZ,IAAIC,EAAY,IAAIC,WAAWF,GAE/BP,EAAUU,UAAU,EAAG,EAAGR,EAAOE,GAwCjC,OAtCW,SAAPO,IAEeC,sBAAsBD,GAEvChC,EAASkC,sBAAsBL,GAE/BR,EAAUc,UAAY,qBACtBd,EAAUe,SAAS,EAAG,EAAGb,EAAOE,GAEhCJ,EAAUgB,UAAY,EACtBhB,EAAUiB,YAAc,eAExBjB,EAAUkB,YAKV,IAHA,IAAIC,EAAqB,EAARjB,EAAcK,EAC3Ba,EAAI,EAEA/C,EAAI,EAAGA,EAAIkC,EAAclC,IAAK,CAEpC,IACIgD,EADIb,EAAUnC,GAAK,IACX+B,EAAO,EAEV,IAAN/B,EACD2B,EAAUsB,OAAOF,EAAGC,GAEpBrB,EAAUuB,OAAOH,EAAGC,GAGtBD,GAAKD,EAGPnB,EAAUuB,OAAO1B,EAAOM,MAAON,EAAOQ,OAAO,GAC7CL,EAAUwB,SAGZb,GAGO3B,I,oBAGT,WAAW,IAAD,OACR,OACE,gCACE,wBAAQyC,UAAU,aAAatB,MAAM,OAAOE,OAAO,QACnD,qBAAKqB,MAAO,CAACC,SAAU,YAAvB,SACG7E,IAAS,IAAIM,KAAI,SAAAwE,GAChB,OACE,uBAAOC,KAAK,QACVC,aAAc,EAAK3E,OAAOyE,GAC1BF,MAAO,CACLK,UAAW,kBACX5B,MAAO,QACPwB,SAAU,WACVK,IAAK,IACLC,KAAQ,GAAFL,GAERM,SAAU,SAACzC,GACTlC,QAAQC,IAAI,EAAKL,QACjBI,QAAQC,IAAIiC,EAAM0C,OAAO1C,OACzB,EAAKtC,OAAOyE,GAAKQ,OAAO3C,EAAM0C,OAAO1C,OACrC,EAAKN,qC,GA3LQxC,IAAM0F,WCPxBC,EAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,8BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,OCDdQ,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFnD,SAASoD,eAAe,SAM1BZ,M","file":"static/js/main.2b6c1396.chunk.js","sourcesContent":["import React from 'react'\nimport './App.css';\nimport * as d3 from 'd3'\n\n// function App() {\n\n\n\n//   return (\n//     <div className=\"App\">\n//       <div>F2</div>\n//       <div>Ok</div>\n//     </div>\n//   );\n// }\n\n// export default App;\n\n\nexport default class App extends React.Component {\n\n    constructor (props) {\n      super(props)\n      this.state = {}\n      this.svgRef = React.createRef()\n      const p = d3.scaleLinear().domain([0,16]).range([0,Math.PI*2])\n      this.values = d3.range(16).map(o=>{return (50*Math.sin(p(o)))+50})\n      // const p = d3.scaleLinear().domain([0,16]).range([0,100])\n      // this.values = d3.range(16).map(o=>{return p(o) })\n    }\n\n    componentDidMount() {\n\n      console.log('mounted')\n\n      const w = 100\n      const h = 30\n\n      const self = this\n\n\n      this.arrayBuffer = this.doAudio()\n\n      // setInterval(()=>{\n      //   const rate = Math.random() * 0.05\n      //   let v = 0\n      //   for (var channel = 0; channel < arrayBuffer.numberOfChannels; channel++) {\n      //     // This gives us the actual array that contains the data\n      //     var nowBuffering = arrayBuffer.getChannelData(channel);\n      //     for (var i = 0; i < arrayBuffer.length; i++) {\n      //       // Math.random() is in [0; 1.0]\n      //       // audio needs to be in [-1.0; 1.0]\n      //       nowBuffering[i] = Math.sin(i*0.01)\n      //       // nowBuffering[i] = v\n      //       v -= rate\n      //       if(v < -1) {\n      //         v= 1\n      //       }\n  \n      //       // nowBuffering[i] = Math.random() * 2 - 1;\n      //     }\n      //   }        \n      // },1000)\n\n\n\n    }\n\n    triggerBufferUpdate () {\n      const stepRate = 24\n      let stepper = 0\n      let stepperIndex = 0\n      const scaleAudioY = d3.scaleLinear().domain([0,100]).range([1,-1])\n      let scaleAudioLerp = d3.scaleLinear().domain([0,stepRate])\n        .range([this.values[stepperIndex], this.values[(stepperIndex+1)%this.values.length]])\n      for (var channel = 0; channel < this.arrayBuffer.numberOfChannels; channel++) {\n        var nowBuffering = this.arrayBuffer.getChannelData(channel);\n        for (var i = 0; i < this.arrayBuffer.length; i++) {\n          // nowBuffering[i] = scaleAudioY(this.values[stepperIndex])\n          nowBuffering[i] = scaleAudioY(scaleAudioLerp(stepper))\n          stepper++;\n          if(stepper > stepRate) {\n            stepper = 0\n            stepperIndex += 1\n            stepperIndex = stepperIndex % this.values.length\n            scaleAudioLerp = d3.scaleLinear().domain([0,stepRate])\n              .range([this.values[stepperIndex], this.values[(stepperIndex+1)%this.values.length]])\n          }\n        }\n      }        \n    }\n\n    doAudio () {\n      var audioCtx = new (window.AudioContext || window.webkitAudioContext)();\n      \n      audioCtx.resume()\n      console.log(audioCtx)\n\n      var analyser = audioCtx.createAnalyser();\n      // analyser.minDecibels = -50;\n      // analyser.maxDecibels = -30;\n      analyser.smoothingTimeConstant = 0.85;\n\n      const gainNode = audioCtx.createGain();\n      console.log(audioCtx.state); // running\n\n\n\n      // Create an empty three-second stereo buffer at the sample rate of the AudioContext\n      var myArrayBuffer = audioCtx.createBuffer(2, audioCtx.sampleRate * 3, audioCtx.sampleRate);\n      this.arrayBuffer = myArrayBuffer\n\n      // Fill the buffer with white noise;\n      // just random values between -1.0 and 1.0\n\n      this.triggerBufferUpdate()\n\n      // Get an AudioBufferSourceNode.\n      // This is the AudioNode to use when we want to play an AudioBuffer\n      var source = audioCtx.createBufferSource();\n\n      // set the buffer in the AudioBufferSourceNode\n      source.buffer = myArrayBuffer;\n      source.connect(analyser)\n\n      gainNode.gain.value = .25\n      source.connect(gainNode)\n      gainNode.connect(audioCtx.destination)\n      source.loop = true\n      source.start();      \n      //source.stop()\n\n      var canvas = document.querySelector('.visualiser');\n      var canvasCtx = canvas.getContext(\"2d\");\n\n      let WIDTH = canvas.width;\n      let HEIGHT = canvas.height;\n  \n      analyser.fftSize = 1024;\n      var bufferLength = analyser.fftSize;\n      console.log(bufferLength);\n      var dataArray = new Uint8Array(bufferLength);\n\n      canvasCtx.clearRect(0, 0, WIDTH, HEIGHT);\n\n      var draw = function() {\n\n        let drawVisual = requestAnimationFrame(draw);\n\n        analyser.getByteTimeDomainData(dataArray);\n\n        canvasCtx.fillStyle = 'rgb(200, 200, 200)';\n        canvasCtx.fillRect(0, 0, WIDTH, HEIGHT);\n\n        canvasCtx.lineWidth = 2;\n        canvasCtx.strokeStyle = 'rgb(0, 0, 0)';\n\n        canvasCtx.beginPath();\n\n        var sliceWidth = WIDTH * 1.0 / bufferLength;\n        var x = 0;\n\n        for(var i = 0; i < bufferLength; i++) {\n\n          var v = dataArray[i] / 128.0;\n          var y = v * HEIGHT/2;\n\n          if(i === 0) {\n            canvasCtx.moveTo(x, y);\n          } else {\n            canvasCtx.lineTo(x, y);\n          }\n\n          x += sliceWidth;\n        }\n\n        canvasCtx.lineTo(canvas.width, canvas.height/2);\n        canvasCtx.stroke();\n      };\n\n      draw();\n\n\n      return myArrayBuffer\n    }\n\n    render () {\n      return (\n        <div>\n          <canvas className='visualiser' width='1024' height='256'/>\n          <div style={{position: 'relative'}}>\n            {d3.range(16).map(d=>{\n              return (\n                <input type='range' \n                  defaultValue={this.values[d]}\n                  style={{\n                    transform: 'rotateZ(270deg)', \n                    width: '200px',\n                    position: 'absolute',\n                    top: 100,\n                    left: d*20                    \n                  }}\n                  onChange={(value)=>{\n                    console.log(this.values)\n                    console.log(value.target.value)\n                    this.values[d] = Number(value.target.value)\n                    this.triggerBufferUpdate()\n                  }}/>\n              ) \n            })}\n          </div>\n        </div>\n      )\n    }\n\n}","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}